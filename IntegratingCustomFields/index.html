



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.3">
    
    
      
        <title>Integrating Custom Fields - Levridge Documentation Production 3</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.30686662.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#introduction" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Levridge Documentation Production 3" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Levridge Documentation Production 3
            </span>
            <span class="md-header-nav__topic">
              
                Integrating Custom Fields
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/Levridge-Tory/LevridgeIntegrationDocs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    levridge-tory.github.io/LevridgeIntegrationDocs
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href=".." class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../Agronomy/" class="md-tabs__link md-tabs__link--active">
          Products
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Levridge Documentation Production 3" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Levridge Documentation Production 3
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/Levridge-Tory/LevridgeIntegrationDocs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    levridge-tory.github.io/LevridgeIntegrationDocs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Products
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Products
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Agronomy/" title="Agronomy" class="md-nav__link">
      Agronomy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../AgronomySales/" title="Agronomy Sales" class="md-nav__link">
      Agronomy Sales
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Commodities/" title="Commodity Accounting" class="md-nav__link">
      Commodity Accounting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Feed/" title="Feed" class="md-nav__link">
      Feed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../equity-management-overview/" title="Equity Management" class="md-nav__link">
      Equity Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Scale-Overview/" title="Scale" class="md-nav__link">
      Scale
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-7" type="checkbox" id="nav-2-7" checked>
    
    <label class="md-nav__link" for="nav-2-7">
      System Information
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-7">
        System Information
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-7-1" type="checkbox" id="nav-2-7-1" checked>
    
    <label class="md-nav__link" for="nav-2-7-1">
      Integration Framework
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-7-1">
        Integration Framework
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Integration-Overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-7-1-2" type="checkbox" id="nav-2-7-1-2" checked>
    
    <label class="md-nav__link" for="nav-2-7-1-2">
      Integrations
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-2-7-1-2">
        Integrations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../D365-CE-to-D365-F&O/" title="D365 CE to D365 F&O" class="md-nav__link">
      D365 CE to D365 F&O
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../D365-F&O-to-D365-CE/" title="D365 F&O to D365 CE" class="md-nav__link">
      D365 F&O to D365 CE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scale-integration/" title="Scale" class="md-nav__link">
      Scale
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Agsync/" title="Agsync" class="md-nav__link">
      Agsync
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Kahler/" title="Kahler" class="md-nav__link">
      Kahler
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Surety/" title="Surety" class="md-nav__link">
      Surety
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../oneWeigh/" title="oneWeigh" class="md-nav__link">
      oneWeigh
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Field-Reveal/" title="Field Reveal" class="md-nav__link">
      Field Reveal
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" title="Integrating Custom Fields" class="md-nav__link md-nav__link--active">
      Integrating Custom Fields
    </a>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-7-1-3" type="checkbox" id="nav-2-7-1-3">
    
    <label class="md-nav__link" for="nav-2-7-1-3">
      Deployment
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-2-7-1-3">
        Deployment
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Deploying-Integration-Framework/" title="Deploying the Integration Framework" class="md-nav__link">
      Deploying the Integration Framework
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ApplicationConfiguration/" title="Application Settings Configuration" class="md-nav__link">
      Application Settings Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../DeployingCustomFieldMappingAssemblies/" title="Deploying Custom Field Mapping Assemblies" class="md-nav__link">
      Deploying Custom Field Mapping Assemblies
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../DeployingCDS/" title="Deploying CDS" class="md-nav__link">
      Deploying CDS
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../print-service/" title="Print Service" class="md-nav__link">
      Print Service
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-7-3" type="checkbox" id="nav-2-7-3">
    
    <label class="md-nav__link" for="nav-2-7-3">
      CE Platform
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-7-3">
        CE Platform
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../CE_Customization_Best_Practices/" title="CE Customization Best Practices" class="md-nav__link">
      CE Customization Best Practices
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CE_to_AX_Integration_Implementation_Checklist/" title="CE to AX Integration Implementation Checklist" class="md-nav__link">
      CE to AX Integration Implementation Checklist
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CE_Implementation_Checklist/" title="CE Implementation Checklist" class="md-nav__link">
      CE Implementation Checklist
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CE_Setup_Records/" title="CE Setup Records" class="md-nav__link">
      CE Setup Records
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../EnvironmentPlanning/" title="Environment Planning" class="md-nav__link">
      Environment Planning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../event_framework/" title="Event Framework" class="md-nav__link">
      Event Framework
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Levridge-Tory/LevridgeIntegrationDocs/edit/master/docs/IntegratingCustomFields.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <!-- -->

<h1 id="introduction"><a class="toclink" href="#introduction">Introduction</a></h1>
<p>In many implementations a client will have specific needs that require custom fields to be added to
existing entities or custom behavior for an existing field in an integration. 
This document shows how to create a custom field extension to have those custom
fields integrated when the entity is being integrated.</p>
<h1 id="overview"><a class="toclink" href="#overview">Overview</a></h1>
<p>In order to integrate custom fields you will need to create a Visual Studio solution with upto three
projects:</p>
<ul>
<li>Custom Source Proxy Project</li>
</ul>
<p>Contains the proxy for the source datasource with the custom fields in the entities
  This project is only necessary if there are custom fields in the source. If your customizations
  only include custom behavior for existing fields then a custom source proxy will not be needed.</p>
<ul>
<li>Custom Destination Proxy Project</li>
</ul>
<p>Contains the proxy for the desitination datasource with the custom fields in the entities
  This project is only necessary if there are custom fields in the destination. If your customizations
  only include custom behavior for existing fields then a custom destination proxy will not be needed.</p>
<ul>
<li>Custom Mapping Project</li>
</ul>
<p>Contains the code needed to map the integration for the custom fields between the source and 
  destination entities</p>
<p><em>Note: If there are no custom fields involved and you are only defining custom behavior
for existing fields you will not need new proxies. You only need a proxy to define the 
metadata for custom fields.</em></p>
<p>Please see <a href="../DeployingCustomFieldMappingAssemblies/">Deploying Custom Field Mapping Assemblies</a> for information
on deploying the custom mapping assembly.</p>
<h1 id="tutorial"><a class="toclink" href="#tutorial">Tutorial</a></h1>
<h2 id="create-the-solution"><a class="toclink" href="#create-the-solution">Create the Solution</a></h2>
<p>The first step is to create a Visual Studio solution for the custom mapping.
In Visual Studio, create a new C# Class Library (.NET Core).
<img alt="Class Library" src="../assets/images/IntegratingCustomFields/ClassLibraryProject.jpg" title="Class Library Project Type" /></p>
<p>You may want to give the solution a different name than the project. In our example, the customer is Comstock
so we will name the solution "ComstockCustomMapping" and the project Levridge.Integration.IntegrationService.Mapping.Comstock.
We recommend you use this naming convention for your custom mapping project: Levridge.Integration.IntegrationService.Mapping.[clientname].
<img alt="Project Configuration" src="../assets/images/IntegratingCustomFields/ConfigureNewProject.jpg" title="New Project Configuration" /></p>
<h2 id="create-the-source-proxy-project"><a class="toclink" href="#create-the-source-proxy-project">Create the Source Proxy Project</a></h2>
<h2 id="create-the-destination-proxy-project"><a class="toclink" href="#create-the-destination-proxy-project">Create the Destination Proxy Project</a></h2>
<h2 id="add-references-to-the-custom-mapping-project"><a class="toclink" href="#add-references-to-the-custom-mapping-project">Add References to the Custom Mapping Project</a></h2>
<p>The Levridge packages are published to our DevOps Artifacts so you will need to add a Nuget source for those
packages. This is done in Visual Studio from Tools/Options/NuGet Package Manager/Package Sources. 
The source is <code>https://pkgs.dev.azure.com/stoneridgesoftware/Levridge/_packaging/LevridgePackages-beta/nuget/v3/index.json</code> 
If you are working the LevDevelopment branch. If you are working in the customer's repository you should use
<code>https://pkgs.dev.azure.com/stoneridgesoftware/Levridge/_packaging/LevridgePackages/nuget/v3/index.json</code> which 
is the released version of the packages.</p>
<p><img alt="NuGet Package Sources Dialog" src="../assets/images/NuGetPackageSourcesDialog.jpg" title="NuGet Package Sources" /></p>
<p>You will need to add the following Nuget references to your custom mapping project:</p>
<ul>
<li>Levridge.EntityFramework</li>
<li>Levridge.Integration.IntegrationService.Abstractions</li>
<li>Levridge.Integration.IntegrationService.Mapping</li>
<li>Microsoft.Extensions.DependencyInjection</li>
<li>System.ComponentModel.Composition</li>
</ul>
<p><em>Note: The Levridge packages are available from our Azure DevOps Artifacts repository. The URL for released packages is
https://pkgs.dev.azure.com/stoneridgesoftware/Levridge/_packaging/LevridgePackages/nuget/v3/index.json</em> </p>
<h2 id="add-source-and-destination-datasource-references-to-custom-mapping-project"><a class="toclink" href="#add-source-and-destination-datasource-references-to-custom-mapping-project">Add Source and Destination Datasource References to Custom Mapping Project</a></h2>
<p>You will need to reference the destination data source project in order to have access to any 
Field types and other types used during mapping. If your datasource is CRM you would include
this reference:
* Levridge.ODataDataSources.CRMODataDataSource</p>
<p>If your datasource is F&amp;O you would include this reference:
* Levridge.DynamicsAxDataSource</p>
<h3 id="update-the-references-to-be-excluded-from-deployment"><a class="toclink" href="#update-the-references-to-be-excluded-from-deployment">Update the references to be excluded from deployment</a></h3>
<p>These references will be needed for the build process, but we will want to use the libraries
provided by the standard deployment and not deploy our own copy of the libraries with the custom
mapping assemblies. To accomplish this, we let the msbuild system know to exclude these
libraries from the runtime deployment by adding <code>&lt;ExcludeAssets&gt;runtime&lt;/ExcludeAssets&gt;</code> to the 
<code>&lt;PackageReference&gt;</code> node for each package. You should have an <code>&lt;ItemGroup&gt;</code> node that looks somthing like
this.</p>
<pre><code>  &lt;ItemGroup&gt;
    &lt;PackageReference Include=&quot;Levridge.EntityFramework&quot; Version=&quot;2.0.10&quot;&gt;
      &lt;ExcludeAssets&gt;runtime&lt;/ExcludeAssets&gt;
    &lt;/PackageReference&gt;
    &lt;PackageReference Include=&quot;Levridge.Integration.IntegrationService.Abstractions&quot; Version=&quot;1.0.0&quot;&gt;
      &lt;ExcludeAssets&gt;runtime&lt;/ExcludeAssets&gt;
    &lt;/PackageReference&gt;
    &lt;PackageReference Include=&quot;Levridge.Integration.IntegrationService.Mapping&quot; Version=&quot;1.0.0&quot;&gt;
      &lt;ExcludeAssets&gt;runtime&lt;/ExcludeAssets&gt;
    &lt;/PackageReference&gt;
    &lt;PackageReference Include=&quot;Levridge.ODataDataSources.CRMODataDataSource&quot; Version=&quot;2.1.15&quot;&gt;
      &lt;ExcludeAssets&gt;runtime&lt;/ExcludeAssets&gt;
    &lt;/PackageReference&gt;
    &lt;PackageReference Include=&quot;Microsoft.Extensions.DependencyInjection&quot; Version=&quot;3.0.2&quot;&gt;
      &lt;ExcludeAssets&gt;runtime&lt;/ExcludeAssets&gt;
    &lt;/PackageReference&gt;
  &lt;/ItemGroup&gt;
</code></pre>

<h2 id="add-a-reference-to-the-two-datasource-proxy-projects"><a class="toclink" href="#add-a-reference-to-the-two-datasource-proxy-projects">Add a reference to the two datasource proxy projects</a></h2>
<p>Your custom mapping methods will need to access the source and data entities so you will need to 
add a reference to the two proxy projects you created in sections <a href="#Create-the-Source-Proxy-Project">Create the Source Proxy Project</a>
and <a href="#Create-the-Destination-Proxy-Project">Create the Destination Proxy Project</a></p>
<p>If you do not need a custom proxy project you should add a reference package to the correct
Levridge nuget package. The F&amp;O and CRM packages are:
* Levridge.DynamicsAxDataSource
* Levridge.ODataDataSources.DynamicsCRM</p>
<h2 id="create-an-entitymapbuilderextension-class"><a class="toclink" href="#create-an-entitymapbuilderextension-class">Create An EntityMapBuilderExtension class</a></h2>
<p>We need to have a class that will contain the necessary mapping methods for the custom
fields being added to the integration.</p>
<ol>
<li>Create a public class 
    This can not be a static class because Microsoft MEF won't export a static class.<ol>
<li>Add the [Export] attribute to the class
    The Export attribute is in the System.ComponentModel.Composition that was added 
    in the section <a href="#Add-References-to-the-Custom-Mapping-Project">Add References to the Custom Mapping Project</a></li>
</ol>
</li>
<li>Name the class 
    We recommend using something like [client]CustomFieldsEntityMapping. The actual name is
    not important, orther than to be clear the purpose of the class. In our example
    we named the class <code>ContosoCustomFieldsEntityMapping</code>.</li>
<li>Add a public static void method that takes a single <code>IServiceCollection</code> parameter.
   In our example we added the following method:
   <code>public static void AddContosoCustomMaps(IServiceCollection services)</code></li>
<li>Add a private static method that takes a single <code>IEntityMapBuilder</code> parameter and returns an <code>IEntityMapBuilder</code>
    and takes two generic parameters.
    In our example we added the following method:
    <code>private static IEntityMapBuilder AddContosoCustomFieldsToMaps&lt;TSource, TTarget&gt;(IEntityMapBuilder builder)</code></li>
<li>
<p>Add the following code to the public static method created in step 3 above:</p>
<p>var builder = new EntityMapBuilder(services);
   ContosoCustomFieldsEntityMapping.AddContosoCustomFieldsToMaps<AxEntities.CustomerV3, CRMEntities.lev_customer>(builder);`</p>
<p>The second line should reference the current class and the method you created in step 4 above.
Here is our complete method in the example:</p>
<p>public static void AddLandusCustomMaps(IServiceCollection services)
   {
       var builder = new EntityMapBuilder(services);
       ContosoCustomFieldsEntityMapping.AddContosoCustomFieldsToMaps<AxEntities.CustomerV3, CRMEntities.lev_customer>(builder);
   }</p>
<p><em>Note: The namespaces AxEntities and CRMEntities should reference your custom proxies if you created them
otherwise it should reference the packaged Levridge provided proxy</em></p>
</li>
<li>
<p>Add the following code to the private static method created in step 4 above:</p>
<p>if (builder == null)
   {
       throw new ArgumentNullException(nameof(builder));
   }
   return EntityMapBuilderHelper.InvokeMappingMethods(builder, typeof(ContosoCustomFieldsEntityMapping));</p>
<p>The first block validates the parameter. The last line calls a method on a helper class to invoke all 
the mapping methods on the class we are now building.
Here is our complete method in the example:</p>
<p>private static IEntityMapBuilder AddContosoCustomFieldsToMaps<TSource, TTarget>(IEntityMapBuilder builder)
   {
       if (builder == null)
       {
           throw new ArgumentNullException(nameof(builder));
       }
       return EntityMapBuilderHelper.InvokeMappingMethods(builder, typeof(ContosoCustomFieldsEntityMapping));
   }</p>
</li>
<li>
<p>Create mapping methods</p>
</li>
<li>
<p>Create a private static method that a single <code>IEntityMapBuilder</code> parameter and returns an <code>IEntityMapBuilder</code>
      Name the method Map[SourceEntity]_[DestinationEntity]. </p>
<p>In our example we added the following method:
  <code>private static IEntityMapBuilder MapCustomerV3_lev_customer(IEntityMapBuilder builder)</code>
  This method will add the custom field mapping for CustomerV3 to lev_customer</p>
</li>
<li>
<p>Add an [EntityMapMethod] Attribute to the map method</p>
</li>
<li>
<p>Add mapping code in the map method
      The mapping code is split into two levels:
        - <a href="../EntityMapBuilderExtensions.AddEntityMap/">AddEntityMap</a>
          The structure of the <code>AddEntityMap</code> is an extension method on <code>IEntityMapBuilder</code> that takes
          two generic parameters for the source and target entities and an <code>Action</code> method parameter used 
          to configure the EntityMap by adding field maps for the entities.
        - <a href="../EntityMap.AddFieldMap/">AddFieldMap</a>
          <code>AddFieldMap</code> is a method on <code>EntityMap</code>. There are several that takes
          two generic parameters for the source field type and target field type and an <code>Action</code> method parameter used 
          to configure the EntityMap by adding field maps for the entities.</p>
<p>Here is an example method that adds mapping for CustomerV3 to lev_customer:</p>
<pre><code>    private static IEntityMapBuilder MapCustomerV3_lev_customer(IEntityMapBuilder builder)
    {
        builder.AddEntityMap&lt;AxEntities.CustomerV3, CRMEntities.lev_customer&gt;(em =&gt;
        {
            em.AddFieldMap&lt;String, String&gt;(
                new JSONField&lt;String&gt;(nameof(AxEntities.CustomerV3.LevPrintName)),
                new CRMODataField&lt;String&gt;(nameof(CRMEntities.lev_customer.lev_name)),
                (a, b) =&gt;
                {
                    String printName = a.Value;
                    String organizationName = (String)a.FieldEntity[nameof(AxEntities.CustomerV3.OrganizationName)].Value;

                  return String.IsNullOrEmpty(printName) ? organizationName : printName;
                },
                (b, a) =&gt;
                {
                    throw new IntegrationNotSupportedException();
                });

            em.AddFieldMap&lt;String, String&gt;(
                new JSONField&lt;String&gt;(nameof(AxEntities.CustomerV3.LevInCareOf)),
                new CRMODataField&lt;String&gt;(nameof(CRMEntities.lev_customer.lev_incareof)));

            em.AddMapReferencedField(nameof(AxEntities.CustomerV3), nameof(AxEntities.CustomerV3.LevPrintName));
        });
        return builder;
    }
</code></pre>
</li>
</ol>
<h3 id="example-mapping"><a class="toclink" href="#example-mapping">Example Mapping</a></h3>
<pre><code>using System;
using Microsoft.Extensions.DependencyInjection;
using Levridge.EntityFramework;
using Levridge.ODataDataSources;
using Levridge.Integration.IntegrationService.Abstractions;
using AxEntities = ContosoCustomFields.Microsoft.Dynamics.DataEntities;
using CRMEntities = ContosoCustomFields.ODataDataSources.DynamicsCRM;
using System.ComponentModel.Composition;

namespace Levridge.Integration.IntegrationService.Mapping.ContosoCustomFields
{
    [Export]
    public class ContosoCustomFieldsEntityMapBuilderExtensions
    {
        public static void AddContosoCustomMaps(IServiceCollection services)
        {
            var builder = new EntityMapBuilder(services);
            ContosoCustomFieldsEntityMapBuilderExtensions.AddContosoCustomFieldsToMaps&lt;AxEntities.CustomerV3, CRMEntities.lev_customer&gt;(builder);
        }

        private static IEntityMapBuilder AddContosoCustomFieldsToMaps&lt;TSource, TTarget&gt;(IEntityMapBuilder builder)
        {
            if (builder == null)
            {
                throw new ArgumentNullException(nameof(builder));
            }
            return EntityMapBuilderHelper.InvokeMappingMethods(builder, typeof(ContosoCustomFieldsEntityMapBuilderExtensions));
        }

        [EntityMapMethod]
        private static IEntityMapBuilder MapCustomerV3_lev_customer(IEntityMapBuilder builder)
        {
            builder.AddEntityMap&lt;AxEntities.CustomerV3, CRMEntities.lev_customer&gt;(em =&gt;
            {
                em.AddFieldMap&lt;String, String&gt;(
                    new JSONField&lt;String&gt;(nameof(AxEntities.CustomerV3.LevPrintName)),
                    new CRMODataField&lt;String&gt;(nameof(CRMEntities.lev_customer.lev_name)),
                    (a, b) =&gt;
                    {
                        String printName = a.Value;
                        String organizationName = (String)a.FieldEntity[nameof(AxEntities.CustomerV3.OrganizationName)].Value;

                        return String.IsNullOrEmpty(printName) ? organizationName : printName;
                    },
                    (b, a) =&gt;
                    {
                        throw new IntegrationNotSupportedException();
                    });

                em.AddFieldMap&lt;String, String&gt;(
                    new JSONField&lt;String&gt;(nameof(AxEntities.CustomerV3.LevInCareOf)),
                    new CRMODataField&lt;String&gt;(nameof(CRMEntities.lev_customer.lev_incareof)));

                em.AddMapReferencedField(nameof(AxEntities.CustomerV3), nameof(AxEntities.CustomerV3.LevPrintName));
            });
            return builder;
        }

        [EntityMapMethod]
        private static IEntityMapBuilder MapCustomerV3_account(IEntityMapBuilder builder)
        {
            builder.AddEntityMap&lt;AxEntities.CustomerV3, CRMEntities.account&gt;(em =&gt;
            {
                em.AddFieldMap&lt;String, String&gt;(
                    new JSONField&lt;String&gt;(nameof(AxEntities.CustomerV3.LevPrintName)),
                    new CRMODataField&lt;String&gt;(nameof(CRMEntities.account.name)),
                    (a, b) =&gt;
                    {
                        String printName = a.Value;
                        String organizationName = (String)a.FieldEntity[nameof(AxEntities.CustomerV3.OrganizationName)].Value;

                        return String.IsNullOrEmpty(printName) ? organizationName : printName;
                    },
                    (b, a) =&gt;
                    {
                        throw new IntegrationNotSupportedException();
                    });
            });
            return builder;
        }

        [EntityMapMethod]
        private static IEntityMapBuilder MapInventSite_lev_companysite(IEntityMapBuilder builder)
        {
            builder.AddEntityMap&lt;AxEntities.InventSite, CRMEntities.lev_companysite&gt;(em =&gt;
            {
                em.AddFieldMap&lt;String, String&gt;(
                    new JSONField&lt;String&gt;(nameof(AxEntities.InventSite.LevRegionId)),
                    new CRMODataField&lt;String&gt;(nameof(CRMEntities.lev_companysite.stn_region)));
            });

            return builder;
        }
    }
}
</code></pre>
<h1 id="deploying-the-custom-mapping-assemblies"><a class="toclink" href="#deploying-the-custom-mapping-assemblies">Deploying the Custom Mapping Assemblies</a></h1>
<p>To deploy the custom assembly you simply copy the output of the mapping assembly to the same
directory that contains the Levridge.Integration.Host assemblies.</p>
<p>See <a href="../DeployingCustomFieldMappingAssemblies/">Deploying Custom Field Mapping Assemblies</a> for more information.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Field-Reveal/" title="Field Reveal" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Field Reveal
              </span>
            </div>
          </a>
        
        
          <a href="../Deploying-Integration-Framework/" title="Deploying the Integration Framework" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Deploying the Integration Framework
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.ac79c3b0.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>