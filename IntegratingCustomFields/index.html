



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.14">
    
    
      
        <title>Integrating Custom Fields - Levridge Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.d3202873.min.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/palette.ff0a5ce4.min.css">
      
      
        
        
        <meta name="theme-color" content="#4051b5">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="Levridge Documentation" class="md-header-nav__button md-logo" aria-label="Levridge Documentation">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Levridge Documentation
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Integrating Custom Fields
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/Levridge-Tory/LevridgeIntegrationDocs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    levridge-tory.github.io/LevridgeIntegrationDocs
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Levridge Documentation" class="md-nav__button md-logo" aria-label="Levridge Documentation">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Levridge Documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/Levridge-Tory/LevridgeIntegrationDocs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    levridge-tory.github.io/LevridgeIntegrationDocs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Products
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Products" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Products
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Agronomy/" title="Agronomy" class="md-nav__link">
      Agronomy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../AgronomySales/" title="Agronomy Sales" class="md-nav__link">
      Agronomy Sales
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Commodities/" title="Commodity Accounting" class="md-nav__link">
      Commodity Accounting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Feed/" title="Feed" class="md-nav__link">
      Feed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Patronage/" title="Equity Management" class="md-nav__link">
      Equity Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6">
    
    <label class="md-nav__link" for="nav-2-6">
      Scale
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Scale" data-md-level="2">
      <label class="md-nav__title" for="nav-2-6">
        <span class="md-nav__icon md-icon"></span>
        Scale
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Scale-Overview/" title="Scale Overview" class="md-nav__link">
      Scale Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scale-settings-configuration/" title="Scale Settings Configuration" class="md-nav__link">
      Scale Settings Configuration
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-7" type="checkbox" id="nav-2-7" checked>
    
    <label class="md-nav__link" for="nav-2-7">
      System Information
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="System Information" data-md-level="2">
      <label class="md-nav__title" for="nav-2-7">
        <span class="md-nav__icon md-icon"></span>
        System Information
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-7-1" type="checkbox" id="nav-2-7-1" checked>
    
    <label class="md-nav__link" for="nav-2-7-1">
      Integration Framework
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Integration Framework" data-md-level="3">
      <label class="md-nav__title" for="nav-2-7-1">
        <span class="md-nav__icon md-icon"></span>
        Integration Framework
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Integration-Overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-7-1-2" type="checkbox" id="nav-2-7-1-2" checked>
    
    <label class="md-nav__link" for="nav-2-7-1-2">
      Integrations
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Integrations" data-md-level="4">
      <label class="md-nav__title" for="nav-2-7-1-2">
        <span class="md-nav__icon md-icon"></span>
        Integrations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../D365-CE-to-D365-F%26O/" title="D365 CE to D365 F&O" class="md-nav__link">
      D365 CE to D365 F&O
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../D365-F%26O-to-D365-CE/" title="D365 F&O to D365 CE" class="md-nav__link">
      D365 F&O to D365 CE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scale-integration/" title="Scale" class="md-nav__link">
      Scale
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Agsync/" title="Agsync" class="md-nav__link">
      Agsync
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Kahler/" title="Kahler" class="md-nav__link">
      Kahler
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Surety/" title="Surety" class="md-nav__link">
      Surety
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../oneWeigh/" title="oneWeigh" class="md-nav__link">
      oneWeigh
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Field-Reveal/" title="Field Reveal" class="md-nav__link">
      Field Reveal
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" title="Integrating Custom Fields" class="md-nav__link md-nav__link--active">
      Integrating Custom Fields
    </a>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-7-1-3" type="checkbox" id="nav-2-7-1-3">
    
    <label class="md-nav__link" for="nav-2-7-1-3">
      Deployment
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Deployment" data-md-level="4">
      <label class="md-nav__title" for="nav-2-7-1-3">
        <span class="md-nav__icon md-icon"></span>
        Deployment
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Deploying-Integration-Framework/" title="Deploying the Integration Framework" class="md-nav__link">
      Deploying the Integration Framework
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ApplicationConfiguration/" title="Application Settings Configuration" class="md-nav__link">
      Application Settings Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../DeployingCustomFieldMappingAssemblies/" title="Deploying Custom Field Mapping Assemblies" class="md-nav__link">
      Deploying Custom Field Mapping Assemblies
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../DeployingCDS/" title="Deploying CDS" class="md-nav__link">
      Deploying CDS
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../print-service/" title="Print Service" class="md-nav__link">
      Print Service
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-7-3" type="checkbox" id="nav-2-7-3">
    
    <label class="md-nav__link" for="nav-2-7-3">
      CE Platform
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="CE Platform" data-md-level="3">
      <label class="md-nav__title" for="nav-2-7-3">
        <span class="md-nav__icon md-icon"></span>
        CE Platform
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../CE_to_AX_Integration_Implementation_Checklist/" title="CE to AX Integration Implementation Checklist" class="md-nav__link">
      CE to AX Integration Implementation Checklist
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CE_Implementation_Checklist/" title="CE Implementation Checklist" class="md-nav__link">
      CE Implementation Checklist
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CE_Setup_Records/" title="CE Setup Records" class="md-nav__link">
      CE Setup Records
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../EnvironmentPlanning/" title="Environment Planning" class="md-nav__link">
      Environment Planning
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Levridge-Tory/LevridgeIntegrationDocs/edit/master/docs/IntegratingCustomFields.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <!-- -->

<h1 id="introduction"><a class="toclink" href="#introduction">Introduction</a></h1>
<p>In many implementations a client will have specific needs that require custom fields to be added to
existing entities or custom behavior for an existing field in an integration. 
This document shows how to create a custom field extension to have those custom
fields integrated when the entity is being integrated.</p>
<h1 id="overview"><a class="toclink" href="#overview">Overview</a></h1>
<p>In order to integrate custom fields you will need to create a Visual Studio solution with upto three
projects:</p>
<ul>
<li>Custom Source Proxy Project</li>
</ul>
<p>Contains the proxy for the source datasource with the custom fields in the entities
  This project is only necessary if there are custom fields in the source. If your customizations
  only include custom behavior for existing fields then a custom source proxy will not be needed.</p>
<ul>
<li>Custom Destination Proxy Project</li>
</ul>
<p>Contains the proxy for the desitination datasource with the custom fields in the entities
  This project is only necessary if there are custom fields in the destination. If your customizations
  only include custom behavior for existing fields then a custom destination proxy will not be needed.</p>
<ul>
<li>Custom Mapping Project</li>
</ul>
<p>Contains the code need to map the integration for the custom fields between the source and 
  destination entities</p>
<p><em>Note: If there are no custom fields involved and you are only defining custom behavior
for existing fields you will not need new proxies. You only need a proxy to define the 
metadata for custom fields.</em></p>
<p>Please see <a href="../DeployingCustomFieldMappingAssemblies/">Deploying Custom Field Mapping Assemblies</a> for information
on deploying the custom mapping assembly.</p>
<h1 id="tutorial"><a class="toclink" href="#tutorial">Tutorial</a></h1>
<h2 id="create-the-solution"><a class="toclink" href="#create-the-solution">Create the Solution</a></h2>
<p>The first step is to create a Visual Studio solution for the custom mapping.
In Visual Studio, create a new C# Class Library (.NET Core).
<img alt="Class Library" src="../assets/images/IntegratingCustomFields/ClassLibraryProject.jpg" title="Class Library Project Type" /></p>
<p>You may want to give the solution a different name than the project. In our example, the customer is Comstock
so we will name the solution "ComstockCustomMapping" and the project Levridge.Integration.IntegrationService.Mapping.Comstock.
We recommend you use this naming convention for your custom mapping project: Levridge.Integration.IntegrationService.Mapping.[clientname].
<img alt="Project Configuration" src="../assets/images/IntegratingCustomFields/ConfigureNewProject.jpg" title="New Project Configuration" /></p>
<h2 id="create-the-source-proxy-project"><a class="toclink" href="#create-the-source-proxy-project">Create the Source Proxy Project</a></h2>
<h2 id="create-the-destination-proxy-project"><a class="toclink" href="#create-the-destination-proxy-project">Create the Destination Proxy Project</a></h2>
<h2 id="add-references-to-the-custom-mapping-project"><a class="toclink" href="#add-references-to-the-custom-mapping-project">Add References to the Custom Mapping Project</a></h2>
<p>The Levridge packages are published to our DevOps Artifacts so you will need to add a Nuget source for those
packages. This is done in Visual Studio from Tools/Options/NuGet Package Manager/Package Sources. 
The source is <code>https://pkgs.dev.azure.com/stoneridgesoftware/Levridge/_packaging/LevridgePackages-beta/nuget/v3/index.json</code> 
If you are working the LevDevelopment branch. If you are working in the customer's repository you should use
<code>https://pkgs.dev.azure.com/stoneridgesoftware/Levridge/_packaging/LevridgePackages/nuget/v3/index.json</code> which 
is the released version of the packages.</p>
<p><img alt="NuGet Package Sources Dialog" src="../assets/images/NuGetPackageSourcesDialog.jpg" title="NuGet Package Sources" /></p>
<p>You will need to add the following Nuget references to your custom mapping project:</p>
<ul>
<li>Levridge.EntityFramework</li>
<li>Levridge.Integration.IntegrationService.Abstractions</li>
<li>Levridge.Integration.IntegrationService.Mapping</li>
<li>Microsoft.Extensions.DependencyInjection</li>
<li>System.ComponentModel.Composition</li>
</ul>
<p><em>Note: The Levridge packages are available from our Azure DevOps Artifacts repository. The URL for released packages is
https://pkgs.dev.azure.com/stoneridgesoftware/Levridge/_packaging/LevridgePackages/nuget/v3/index.json</em> </p>
<h2 id="add-source-and-destination-datasource-references-to-custom-mapping-project"><a class="toclink" href="#add-source-and-destination-datasource-references-to-custom-mapping-project">Add Source and Destination Datasource References to Custom Mapping Project</a></h2>
<p>You will need to reference the destination data source project in order to have access to any 
Field types and other types used during mapping. If your datasource is CRM you would include
this reference:
* Levridge.ODataDataSources.CRMODataDataSource</p>
<p>If your datasource is F&amp;O you would include this reference:
* Levridge.DynamicsAxDataSource</p>
<h3 id="update-the-references-to-be-excluded-from-deployment"><a class="toclink" href="#update-the-references-to-be-excluded-from-deployment">Update the references to be excluded from deployment</a></h3>
<p>These references will be needed for the build process, but we will want to use the libraries
provided by the standard deployment and not deploy our own copy of the libraries with the custom
mapping assemblies. To accomplish this, we let the msbuild system know to exclude these
libraries from the runtime deployment by adding <code>&lt;ExcludeAssets&gt;runtime&lt;/ExcludeAssets&gt;</code> to the 
<code>&lt;PackageReference&gt;</code> node for each package. You should have an <code>&lt;ItemGroup&gt;</code> node that looks somthing like
this.</p>
<pre><code>  &lt;ItemGroup&gt;
    &lt;PackageReference Include=&quot;Levridge.EntityFramework&quot; Version=&quot;2.0.10&quot;&gt;
      &lt;ExcludeAssets&gt;runtime&lt;/ExcludeAssets&gt;
    &lt;/PackageReference&gt;
    &lt;PackageReference Include=&quot;Levridge.Integration.IntegrationService.Abstractions&quot; Version=&quot;1.0.0&quot;&gt;
      &lt;ExcludeAssets&gt;runtime&lt;/ExcludeAssets&gt;
    &lt;/PackageReference&gt;
    &lt;PackageReference Include=&quot;Levridge.Integration.IntegrationService.Mapping&quot; Version=&quot;1.0.0&quot;&gt;
      &lt;ExcludeAssets&gt;runtime&lt;/ExcludeAssets&gt;
    &lt;/PackageReference&gt;
    &lt;PackageReference Include=&quot;Levridge.ODataDataSources.CRMODataDataSource&quot; Version=&quot;2.1.15&quot;&gt;
      &lt;ExcludeAssets&gt;runtime&lt;/ExcludeAssets&gt;
    &lt;/PackageReference&gt;
    &lt;PackageReference Include=&quot;Microsoft.Extensions.DependencyInjection&quot; Version=&quot;3.0.2&quot;&gt;
      &lt;ExcludeAssets&gt;runtime&lt;/ExcludeAssets&gt;
    &lt;/PackageReference&gt;
  &lt;/ItemGroup&gt;
</code></pre>

<h2 id="add-a-reference-to-the-two-datasource-proxy-projects"><a class="toclink" href="#add-a-reference-to-the-two-datasource-proxy-projects">Add a reference to the two datasource proxy projects</a></h2>
<p>Your custom mapping methods will need to access the source and data entities so you will need to 
add a reference to the two proxy projects you created in sections <a href="#Create-the-Source-Proxy-Project">Create the Source Proxy Project</a>
and <a href="#Create-the-Destination-Proxy-Project">Create the Destination Proxy Project</a></p>
<p>If you do not need a custom proxy project you should add a reference package to the correct
Levridge nuget package. The F&amp;O and CRM packages are:
* Levridge.DynamicsAxDataSource
* Levridge.ODataDataSources.DynamicsCRM</p>
<h2 id="create-an-entitymapbuilderextension-class"><a class="toclink" href="#create-an-entitymapbuilderextension-class">Create An EntityMapBuilderExtension class</a></h2>
<p>We need to have a class that will contain the necessary mapping methods for the custom
fields being added to the integration.</p>
<ol>
<li>Create a public class 
    This can not be a static class because Microsoft MEF won't export a static class.<ol>
<li>Add the [Export] attribute to the class
    The Export attribute is in the System.ComponentModel.Composition that was added 
    in the section <a href="#Add-References-to-the-Custom-Mapping-Project">Add References to the Custom Mapping Project</a></li>
</ol>
</li>
<li>Name the class 
    We recommend using something like [client]CustomFieldsEntityMapping. The actual name is
    not important, orther than to be clear the purpose of the class. In our example
    we named the class <code>ContosoCustomFieldsEntityMapping</code>.</li>
<li>Add a public static void method that takes a single <code>IServiceCollection</code> parameter.
   In our example we added the following method:
   <code>public static void AddContosoCustomMaps(IServiceCollection services)</code></li>
<li>Add a private static method that takes a single <code>IEntityMapBuilder</code> parameter and returns an <code>IEntityMapBuilder</code>
    and takes two generic parameters.
    In our example we added the following method:
    <code>private static IEntityMapBuilder AddContosoCustomFieldsToMaps&lt;TSource, TTarget&gt;(IEntityMapBuilder builder)</code></li>
<li>
<p>Add the following code to the public static method created in step 3 above:</p>
<p>var builder = new EntityMapBuilder(services);
   ContosoCustomFieldsEntityMapping.AddContosoCustomFieldsToMaps<AxEntities.CustomerV3, CRMEntities.lev_customer>(builder);`</p>
<p>The second line should reference the current class and the method you created in step 4 above.
Here is our complete method in the example:</p>
<p>public static void AddLandusCustomMaps(IServiceCollection services)
   {
       var builder = new EntityMapBuilder(services);
       ContosoCustomFieldsEntityMapping.AddContosoCustomFieldsToMaps<AxEntities.CustomerV3, CRMEntities.lev_customer>(builder);
   }</p>
<p><em>Note: The namespaces AxEntities and CRMEntities should reference your custom proxies if you created them
otherwise it should reference the packaged Levridge provided proxy</em></p>
</li>
<li>
<p>Add the following code to the private static method created in step 4 above:</p>
<p>if (builder == null)
   {
       throw new ArgumentNullException(nameof(builder));
   }
   return EntityMapBuilderHelper.InvokeMappingMethods(builder, typeof(ContosoCustomFieldsEntityMapping));</p>
<p>The first block validates the parameter. The last line calls a method on a helper class to invoke all 
the mapping methods on the class we are now building.
Here is our complete method in the example:</p>
<p>private static IEntityMapBuilder AddContosoCustomFieldsToMaps<TSource, TTarget>(IEntityMapBuilder builder)
   {
       if (builder == null)
       {
           throw new ArgumentNullException(nameof(builder));
       }
       return EntityMapBuilderHelper.InvokeMappingMethods(builder, typeof(ContosoCustomFieldsEntityMapping));
   }</p>
</li>
<li>
<p>Create mapping methods</p>
</li>
<li>
<p>Create a private static method that a single <code>IEntityMapBuilder</code> parameter and returns an <code>IEntityMapBuilder</code>
      Name the method Map[SourceEntity]_[DestinationEntity]. </p>
<p>In our example we added the following method:
  <code>private static IEntityMapBuilder MapCustomerV3_lev_customer(IEntityMapBuilder builder)</code>
  This method will add the custom field mapping for CustomerV3 to lev_customer</p>
</li>
<li>
<p>Add an [EntityMapMethod] Attribute to the map method</p>
</li>
<li>
<p>Add mapping code in the map method
      The mapping code is split into two levels:
        - <a href="../EntityMapBuilderExtensions.AddEntityMap/">AddEntityMap</a>
          The structure of the <code>AddEntityMap</code> is an extension method on <code>IEntityMapBuilder</code> that takes
          two generic parameters for the source and target entities and an <code>Action</code> method parameter used 
          to configure the EntityMap by adding field maps for the entities.
        - <a href="../EntityMap.AddFieldMap/">AddFieldMap</a>
          <code>AddFieldMap</code> is a method on <code>EntityMap</code>. There are several that takes
          two generic parameters for the source field type and target field type and an <code>Action</code> method parameter used 
          to configure the EntityMap by adding field maps for the entities.</p>
<p>Here is an example method that adds mapping for CustomerV3 to lev_customer:</p>
<pre><code>    private static IEntityMapBuilder MapCustomerV3_lev_customer(IEntityMapBuilder builder)
    {
        builder.AddEntityMap&lt;AxEntities.CustomerV3, CRMEntities.lev_customer&gt;(em =&gt;
        {
            em.AddFieldMap&lt;String, String&gt;(
                new JSONField&lt;String&gt;(nameof(AxEntities.CustomerV3.LevPrintName)),
                new CRMODataField&lt;String&gt;(nameof(CRMEntities.lev_customer.lev_name)),
                (a, b) =&gt;
                {
                    String printName = a.Value;
                    String organizationName = (String)a.FieldEntity[nameof(AxEntities.CustomerV3.OrganizationName)].Value;

                  return String.IsNullOrEmpty(printName) ? organizationName : printName;
                },
                (b, a) =&gt;
                {
                    throw new IntegrationNotSupportedException();
                });

            em.AddFieldMap&lt;String, String&gt;(
                new JSONField&lt;String&gt;(nameof(AxEntities.CustomerV3.LevInCareOf)),
                new CRMODataField&lt;String&gt;(nameof(CRMEntities.lev_customer.lev_incareof)));

            em.AddMapReferencedField(nameof(AxEntities.CustomerV3), nameof(AxEntities.CustomerV3.LevPrintName));
        });
        return builder;
    }
</code></pre>
</li>
</ol>
<h3 id="example-mapping"><a class="toclink" href="#example-mapping">Example Mapping</a></h3>
<pre><code>using System;
using Microsoft.Extensions.DependencyInjection;
using Levridge.EntityFramework;
using Levridge.ODataDataSources;
using Levridge.Integration.IntegrationService.Abstractions;
using AxEntities = ContosoCustomFields.Microsoft.Dynamics.DataEntities;
using CRMEntities = ContosoCustomFields.ODataDataSources.DynamicsCRM;
using System.ComponentModel.Composition;

namespace Levridge.Integration.IntegrationService.Mapping.ContosoCustomFields
{
    [Export]
    public class ContosoCustomFieldsEntityMapBuilderExtensions
    {
        public static void AddContosoCustomMaps(IServiceCollection services)
        {
            var builder = new EntityMapBuilder(services);
            ContosoCustomFieldsEntityMapBuilderExtensions.AddContosoCustomFieldsToMaps&lt;AxEntities.CustomerV3, CRMEntities.lev_customer&gt;(builder);
        }

        private static IEntityMapBuilder AddContosoCustomFieldsToMaps&lt;TSource, TTarget&gt;(IEntityMapBuilder builder)
        {
            if (builder == null)
            {
                throw new ArgumentNullException(nameof(builder));
            }
            return EntityMapBuilderHelper.InvokeMappingMethods(builder, typeof(ContosoCustomFieldsEntityMapBuilderExtensions));
        }

        [EntityMapMethod]
        private static IEntityMapBuilder MapCustomerV3_lev_customer(IEntityMapBuilder builder)
        {
            builder.AddEntityMap&lt;AxEntities.CustomerV3, CRMEntities.lev_customer&gt;(em =&gt;
            {
                em.AddFieldMap&lt;String, String&gt;(
                    new JSONField&lt;String&gt;(nameof(AxEntities.CustomerV3.LevPrintName)),
                    new CRMODataField&lt;String&gt;(nameof(CRMEntities.lev_customer.lev_name)),
                    (a, b) =&gt;
                    {
                        String printName = a.Value;
                        String organizationName = (String)a.FieldEntity[nameof(AxEntities.CustomerV3.OrganizationName)].Value;

                        return String.IsNullOrEmpty(printName) ? organizationName : printName;
                    },
                    (b, a) =&gt;
                    {
                        throw new IntegrationNotSupportedException();
                    });

                em.AddFieldMap&lt;String, String&gt;(
                    new JSONField&lt;String&gt;(nameof(AxEntities.CustomerV3.LevInCareOf)),
                    new CRMODataField&lt;String&gt;(nameof(CRMEntities.lev_customer.lev_incareof)));

                em.AddMapReferencedField(nameof(AxEntities.CustomerV3), nameof(AxEntities.CustomerV3.LevPrintName));
            });
            return builder;
        }

        [EntityMapMethod]
        private static IEntityMapBuilder MapCustomerV3_account(IEntityMapBuilder builder)
        {
            builder.AddEntityMap&lt;AxEntities.CustomerV3, CRMEntities.account&gt;(em =&gt;
            {
                em.AddFieldMap&lt;String, String&gt;(
                    new JSONField&lt;String&gt;(nameof(AxEntities.CustomerV3.LevPrintName)),
                    new CRMODataField&lt;String&gt;(nameof(CRMEntities.account.name)),
                    (a, b) =&gt;
                    {
                        String printName = a.Value;
                        String organizationName = (String)a.FieldEntity[nameof(AxEntities.CustomerV3.OrganizationName)].Value;

                        return String.IsNullOrEmpty(printName) ? organizationName : printName;
                    },
                    (b, a) =&gt;
                    {
                        throw new IntegrationNotSupportedException();
                    });
            });
            return builder;
        }

        [EntityMapMethod]
        private static IEntityMapBuilder MapInventSite_lev_companysite(IEntityMapBuilder builder)
        {
            builder.AddEntityMap&lt;AxEntities.InventSite, CRMEntities.lev_companysite&gt;(em =&gt;
            {
                em.AddFieldMap&lt;String, String&gt;(
                    new JSONField&lt;String&gt;(nameof(AxEntities.InventSite.LevRegionId)),
                    new CRMODataField&lt;String&gt;(nameof(CRMEntities.lev_companysite.stn_region)));
            });

            return builder;
        }
    }
}
</code></pre>
<h1 id="deploying-the-custom-mapping-assemblies"><a class="toclink" href="#deploying-the-custom-mapping-assemblies">Deploying the Custom Mapping Assemblies</a></h1>
<p>To deploy the custom assembly you simply copy the output of the mapping assembly to the same
directory that contains the Levridge.Integration.Host assemblies.</p>
<p>See <a href="../DeployingCustomFieldMappingAssemblies/">Deploying Custom Field Mapping Assemblies</a> for more information.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../Field-Reveal/" title="Field Reveal" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Field Reveal
              </div>
            </div>
          </a>
        
        
          <a href="../Deploying-Integration-Framework/" title="Deploying the Integration Framework" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Deploying the Integration Framework
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.2d1db4bd.min.js"></script>
      <script src="../assets/javascripts/bundle.6627ddf3.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>